@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&family=Outfit:wght@500;700;900&display=swap');

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
   background-color: #0b1121;
   margin: 0; padding: 0;
   font-family: 'Inter', sans-serif;
   color: #cbd5e1;
   font-size: 15px;
   /* KH√ìA CU·ªòN TRANG WEB - CH·ªà CU·ªòN KHUNG CHAT */
   overflow: hidden; 
   position: fixed; 
   width: 100%; 
   height: 100%;
   -webkit-text-size-adjust: 100%; /* NgƒÉn zoom ch·ªØ tr√™n iOS */
   touch-action: manipulation; /* C·∫£i thi·ªán ph·∫£n h·ªìi c·∫£m ·ª©ng */
}

.chat-container {
   /* GHIM CH·∫∂T KHUNG CHAT V√ÄO 4 G√ìC M√ÄN H√åNH */
   position: absolute;
   top: 0; left: 0; right: 0; bottom: 0;
   display: flex;
   flex-direction: column;
   height: 100%;     /* Fallback */
   height: 100dvh;  /* Chi·ªÅu cao th·ª±c t·∫ø tr√™n Mobile */
   overflow: hidden;
   min-height: -webkit-fill-available; /* Fix chi·ªÅu cao Safari mobile */
}

/* HEADER */
header {
   flex-shrink: 0;
   background: rgba(11, 17, 33, 0.95);
   backdrop-filter: blur(10px);
   z-index: 10;
   border-bottom: 1px solid #1e293b;
   padding: 0.5rem 0; /* Th√™m padding cho mobile */
}

/* --- ‚ú® RAG STATUS BAR NEON --- */
.rag-bar-container {
   background: rgba(15, 23, 42, 0.9);
   border: 1px solid #334155;
   border-radius: 8px;
   padding: 8px 12px;
   margin: 8px 0.5rem; /* Thay ƒë·ªïi margin ƒë·ªÉ ph√π h·ª£p v·ªõi padding m·ªõi c·ªßa header */
   box-shadow: 0 0 15px rgba(59, 130, 246, 0.1);
   border-left: 3px solid #3b82f6;
   animation: slideIn 0.3s ease-out;
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ tr√™n mobile */
}

/* Thanh ti·∫øn tr√¨nh ph√°t s√°ng */
.rag-progress-track {
   background: #1e293b;
   height: 4px; /* Gi·∫£m chi·ªÅu cao tr√™n mobile */
   border-radius: 10px;
   overflow: hidden;
   margin-top: 4px; /* Gi·∫£m margin */
   position: relative;
}

.rag-progress-fill {
   height: 100%;
   background: linear-gradient(90deg, #3b82f6, #8b5cf6, #2dd4bf);
   background-size: 200% 200%;
   width: 0%;
   box-shadow: 0 0 10px #3b82f6; /* Glow effect */
   transition: width 0.1s linear;
   animation: neon-flow 2s infinite linear; /* T√°i s·ª≠ d·ª•ng animation c√≥ s·∫µn */
}

/* Ch·ªØ nh·∫•p nh√°y */
.rag-text-glow {
   color: #60a5fa;
   text-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
   font-family: 'JetBrains Mono', monospace;
   font-size: 11px;
}

@keyframes slideIn {
   from { opacity: 0; transform: translateY(5px); }
   to { opacity: 1; transform: translateY(0); }
}

/* KHUNG CHAT */
.messages-area {
   flex: 1;
   overflow-y: auto;
   padding: 0.75rem 0.5rem; /* Gi·∫£m padding tr√™n mobile */
   width: 100%;
   scroll-behavior: auto; 
   min-height: 0;
   -webkit-overflow-scrolling: touch;
   padding-bottom: 20px;
   overscroll-behavior-y: contain; 
}

.messages-area::-webkit-scrollbar { width: 3px; } /* Gi·∫£m ƒë·ªô r·ªông thanh cu·ªôn tr√™n mobile */
.messages-area::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }

.message { margin-bottom: 1.5rem; animation: fadeIn 0.3s ease-out; } /* Gi·∫£m margin */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.user-message { display: flex; justify-content: flex-end; }
.user-bubble {
   background: linear-gradient(135deg, #2563eb, #1d4ed8);
   color: white;
   padding: 0.6rem 0.9rem; /* Gi·∫£m padding tr√™n mobile */
   border-radius: 1.2rem 1.2rem 0 1.2rem;
   max-width: 85%;
   font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
   word-wrap: break-word;
   overflow-wrap: break-word;
   line-height: 1.4; /* TƒÉng kho·∫£ng c√°ch d√≤ng cho d·ªÖ ƒë·ªçc */
}

/* AI CARD & STYLING */
.ai-response-group {
   display: flex; flex-direction: column; gap: 12px; /* Gi·∫£m gap tr√™n mobile */
   width: 100%;
}

.ai-card {
   background: #151e32;
   border: 1px solid #334155;
   border-radius: 10px; /* Gi·∫£m border-radius tr√™n mobile */
   overflow: hidden;
   transition: border-color 0.3s;
}
.ai-card:hover { border-color: #475569; }

.ai-header {
   background: #0f172a;
   padding: 5px 10px; /* Gi·∫£m padding tr√™n mobile */
   font-size: 10px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #94a3b8;
   border-bottom: 1px solid #1e293b;
   display: flex; justify-content: space-between; align-items: center;
}
.ai-model-name { font-weight: bold; color: #38bdf8; display: flex; align-items: center; gap: 5px; }

.ai-bubble {
   padding: 0.9rem; /* Gi·∫£m padding tr√™n mobile */
   color: #e2e8f0;
   line-height: 1.6; /* ƒêi·ªÅu ch·ªânh line-height cho mobile */
   letter-spacing: 0.015em;
   font-weight: 300;
   font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   word-wrap: break-word;
   overflow-wrap: break-word; /* Quan tr·ªçng ƒë·ªÉ kh√¥ng v·ª° layout */
}

/* --- ‚ú® NEON CYBERPUNK STYLES (UPGRADE) --- */
/* --- PYTHON TERMINAL & PLOT STYLES --- */
.code-action-bar {
   display: flex; justify-content: flex-end; gap: 8px; /* Gi·∫£m gap tr√™n mobile */
   background: #1e293b; padding: 4px 8px; /* Gi·∫£m padding tr√™n mobile */
   border-top: 1px solid #334155; border-radius: 0 0 8px 8px;
   margin-top: -1em; margin-bottom: 1em; /* D√≠nh li·ªÅn v·ªõi khung code */
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}
.run-btn {
   font-size: 11px; font-weight: bold; color: #a5f3fc; cursor: pointer; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   display: flex; align-items: center; gap: 4px; /* Gi·∫£m gap */
   transition: 0.3s;
   padding: 4px 8px; /* Th√™m padding cho d·ªÖ ch·∫°m */
   border-radius: 4px;
}
.run-btn:hover { color: #22d3ee; text-shadow: 0 0 8px #22d3ee; }

.python-output {
   margin-top: 8px; padding: 8px; /* Gi·∫£m margin v√† padding */
   border-radius: 8px;
   background: #000; border: 1px dashed #334155;
   font-family: 'JetBrains Mono', monospace; font-size: 12px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #fff;
   display: none; /* ·∫®n khi ch∆∞a c√≥ k·∫øt qu·∫£ */
}
.python-output.active { display: block; animation: fadeIn 0.3s; }
.python-output img { 
   max-width: 100%; 
   height: auto;
   display: block;
   margin: 0 auto;
   border-radius: 6px; 
   border: 1px solid #334155; 
   box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
}

/* 1. Headers: M√†u chuy·ªÉn ƒë·ªông & Ph√°t s√°ng */
@keyframes neon-flow {
   0% { background-position: 0% 50%; }
   50% { background-position: 100% 50%; }
   100% { background-position: 0% 50%; }
}

.ai-bubble h1, .ai-bubble h2, .ai-bubble h3 { 
   font-family: 'Outfit', sans-serif; 
   letter-spacing: -0.02em;
   font-weight: 800;
   margin-top: 1em; /* Gi·∫£m margin */
   margin-bottom: 0.5em; /* Gi·∫£m margin */
   background: linear-gradient(270deg, #3b82f6, #8b5cf6, #f472b6, #3b82f6);
   background-size: 300% 300%;
   -webkit-background-clip: text;
   -webkit-text-fill-color: transparent;
   animation: neon-flow 6s ease infinite;
   filter: drop-shadow(0 0 5px rgba(139, 92, 246, 0.3));
}

.ai-bubble h1 { 
   font-size: 1.5em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ tr√™n mobile */
   border-bottom: 2px solid #334155; 
   padding-bottom: 0.3em;
   border-image: linear-gradient(to right, #3b82f6, #f472b6, transparent) 1;
}

.ai-bubble h2 { 
   font-size: 1.3em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ tr√™n mobile */
}

.ai-bubble h3 { 
   font-size: 1.1em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ tr√™n mobile */
}

/* 2. Text Emphasis: T√¥ ƒë·∫≠m & Nghi√™ng ph√°t s√°ng */
.ai-bubble strong { 
   color: #facc15; 
   font-weight: 700;
   text-shadow: 0 0 10px rgba(250, 204, 21, 0.4);
}
.ai-bubble em { 
   color: #f472b6; 
   font-style: italic;
   text-shadow: 0 0 8px rgba(244, 114, 182, 0.4);
}
.ai-bubble u { text-decoration-color: #38bdf8; text-decoration-thickness: 2px; }

/* 3. Lists */
.ai-bubble ul, .ai-bubble ol { 
   padding-left: 1.2em; /* Gi·∫£m padding */
   margin: 0.6em 0; /* Gi·∫£m margin */
   color: #cbd5e1; 
}
.ai-bubble ul li::marker { color: #f472b6; }
.ai-bubble ol li::marker { color: #38bdf8; font-weight: bold; }

/* 4. Blockquotes: K√≠nh trong su·ªët (Glassmorphism) */
.ai-bubble blockquote { 
   border-left: 4px solid #a855f7;
   background: linear-gradient(90deg, rgba(168, 85, 247, 0.1), transparent);
   padding: 0.8em; /* Gi·∫£m padding */
   margin: 0.8em 0; /* Gi·∫£m margin */
   border-radius: 0 10px 10px 0; /* Gi·∫£m border-radius */
   color: #e2e8f0; 
   box-shadow: inset 10px 0 20px -10px rgba(168, 85, 247, 0.2);
   font-size: 0.95em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

/* 5. Inline Code: N·ªÅn t·ªëi + Vi·ªÅn neon */
.ai-bubble p code, .ai-bubble li code {
   font-family: 'JetBrains Mono', monospace;
   background: rgba(15, 23, 42, 0.8); 
   color: #2dd4bf;
   border: 1px solid rgba(45, 212, 191, 0.3);
   padding: 1px 4px; /* Gi·∫£m padding */
   border-radius: 4px; /* Gi·∫£m border-radius */
   font-size: 0.85em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   box-shadow: 0 0 5px rgba(45, 212, 191, 0.1);
}

/* 6. Links */
.ai-bubble a { 
   color: #38bdf8;
   text-decoration: none; 
   border-bottom: 1px dashed #38bdf8; 
   transition: all 0.2s;
   word-break: break-all; /* Ng·∫Øt link d√†i tr√™n mobile */
}
.ai-bubble a:hover { 
   color: #fff;
   background: #0ea5e9;
   padding: 0 2px; /* Gi·∫£m padding */
   border-radius: 4px;
   box-shadow: 0 0 10px #0ea5e9;
   border-bottom: none;
}

/* --- FIX L·ªñI ƒê∆† C·∫¢M ·ª®NG & √âP SCROLL (V2) --- */

/* 1. C·∫•u h√¨nh chung cho Code & Table */
.ai-bubble pre, 
.ai-bubble table {
   background: #282c34; 
   border-radius: 0.5rem;
   border: 1px solid #475569;
   display: block;
   width: 100%;
   overflow-x: auto !important;
   -webkit-overflow-scrolling: touch;
   margin: 0.8em 0; /* Gi·∫£m margin */
}

/* 2. Style ri√™ng cho Code block */
.ai-bubble pre {
   margin: 0.8em 0; /* Gi·∫£m margin */
   padding: 0.8em; /* Gi·∫£m padding */
   position: relative;
   font-size: 0.85em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

/* Style cho Text Art / Neon Code */
.ai-bubble pre code.language-text {
   color: #a5f3fc !important;
   text-shadow: 0 0 6px #0891b2;
   font-weight: 700;
   line-height: 1.1;
}

.ai-bubble pre code {
   font-family: 'JetBrains Mono', monospace;
   font-size: 12px;
   background: transparent;
   padding: 0;
   color: inherit; 
   white-space: pre;
}

/* 3. Style ri√™ng cho Table */
.ai-bubble table {
   border-collapse: collapse; 
   margin: 0.8em 0; /* Gi·∫£m margin */
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}
.ai-bubble th, .ai-bubble td { 
   border: 1px solid #334155; 
   padding: 8px; /* Gi·∫£m padding */
   text-align: left; 
   white-space: nowrap; 
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}
.ai-bubble th { 
   background: #1e293b; 
   color: #38bdf8; 
   font-size: 0.95em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   padding: 10px 8px; /* ƒêi·ªÅu ch·ªânh padding */
}

/* üî• C·∫§P C·ª®U MOBILE: √âp chi·ªÅu r·ªông khung code nh·ªè h∆°n m√†n h√¨nh üî• */
@media (max-width: 768px) {
   .ai-bubble pre,
   .ai-bubble table {
       max-width: calc(100vw - 40px) !important; /* Gi·∫£m kho·∫£ng tr·ª´ ƒë·ªÉ ph√π h·ª£p h∆°n */
       display: block;
   }
   
   /* ƒêi·ªÅu ch·ªânh th√™m cho table tr√™n mobile r·∫•t nh·ªè */
   @media (max-width: 480px) {
       .ai-bubble table {
           font-size: 0.8em;
       }
       .ai-bubble th, .ai-bubble td {
           padding: 6px 4px;
       }
   }
}

/* SUGGESTION CHIPS */
.suggestion-chips { 
   display: flex; 
   gap: 6px; /* Gi·∫£m gap tr√™n mobile */
   overflow-x: auto; 
   padding: 0 0.5rem 0.5rem 0.5rem; /* ƒêi·ªÅu ch·ªânh padding */
   scrollbar-width: none; 
   margin-top: 0.5rem;
}
.suggestion-chips::-webkit-scrollbar { display: none; }
.chip {
   flex-shrink: 0; 
   background: #1e293b; 
   color: #94a3b8; 
   border: 1px solid #334155;
   padding: 5px 10px; /* Gi·∫£m padding */
   border-radius: 16px; /* Gi·∫£m border-radius */
   font-size: 11px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   cursor: pointer; 
   transition: 0.2s;
   white-space: nowrap;
}
.chip:hover { background: #334155; color: #fff; border-color: #60a5fa; }

/* INPUT AREA */
.input-area {
   flex-shrink: 0; 
   padding: 0.5rem 0.5rem 0.7rem 0.5rem; /* Gi·∫£m padding tr√™n mobile */
   background: #0b1121; 
   border-top: 1px solid #1e293b; 
   z-index: 20;
}

.squad-mode-toggle {
   display: flex; 
   align-items: center; 
   gap: 6px; /* Gi·∫£m gap */
   font-size: 10px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #94a3b8; 
   cursor: pointer; 
   user-select: none;
   padding: 3px 6px; /* Gi·∫£m padding */
   border-radius: 10px; /* Gi·∫£m border-radius */
   margin-bottom: 0.5rem;
}
.toggle-switch {
   position: relative; 
   width: 30px; /* Gi·∫£m k√≠ch th∆∞·ªõc */
   height: 16px; /* Gi·∫£m k√≠ch th∆∞·ªõc */
   background: #334155; 
   border-radius: 15px; 
   transition: 0.3s;
}
.toggle-switch::after {
   content: ''; 
   position: absolute; 
   top: 2px; 
   left: 2px; 
   width: 12px; /* Gi·∫£m k√≠ch th∆∞·ªõc */
   height: 12px; /* Gi·∫£m k√≠ch th∆∞·ªõc */
   background: white; 
   border-radius: 50%; 
   transition: 0.3s;
}
.squad-mode-toggle.active .toggle-switch { background: #8b5cf6; }
.squad-mode-toggle.active .toggle-switch::after { transform: translateX(14px); }
.squad-mode-toggle.active span { color: #a78bfa; font-weight: bold; }

.input-wrapper {
   background: #1e293b; 
   border-radius: 20px; /* Gi·∫£m border-radius */
   border: 1px solid #334155;
   display: flex; 
   align-items: flex-end; 
   padding: 5px; /* Gi·∫£m padding */
   transition: border-color 0.2s;
   min-height: 44px; /* ƒê·∫£m b·∫£o ƒë·ªß l·ªõn ƒë·ªÉ ch·∫°m */
}
.input-wrapper:focus-within { 
   border-color: #3b82f6; 
   box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); 
}

textarea {
   width: 100%; 
   background: transparent; 
   border: none; 
   outline: none; 
   color: white;
   padding: 8px 10px; /* Gi·∫£m padding */
   resize: none; 
   max-height: 120px; 
   min-height: 36px; /* Gi·∫£m min-height */
   font-size: 15px; /* Gi·ªØ nguy√™n k√≠ch th∆∞·ªõc ch·ªØ cho input */
   line-height: 1.4;
   font-family: 'Inter', sans-serif;
}

.action-btn {
   background: transparent; 
   color: #94a3b8; 
   width: 38px; /* TƒÉng k√≠ch th∆∞·ªõc cho d·ªÖ ch·∫°m */
   height: 38px; /* TƒÉng k√≠ch th∆∞·ªõc cho d·ªÖ ch·∫°m */
   border-radius: 50%; 
   display: flex; 
   align-items: center; 
   justify-content: center;
   margin-bottom: 3px; 
   cursor: pointer; 
   border: none; 
   transition: 0.2s;
   flex-shrink: 0;
}
.action-btn:hover { color: #e2e8f0; background: #334155; }
.send-btn { color: #3b82f6; }
.send-btn:hover { background: #2563eb; color: white; }
.stop-btn { color: #ef4444; display: none; }
.stop-btn:hover { background: #dc2626; color: white; }

/* MODAL */
.modal-overlay {
   position: fixed; 
   top: 0; 
   left: 0; 
   width: 100%; 
   height: 100%;
   background: rgba(0, 0, 0, 0.85); 
   backdrop-filter: blur(5px);
   display: none; 
   justify-content: center; 
   align-items: center; 
   z-index: 50;
}
.modal-overlay.active { display: flex; }
.modal-content {
   background: #151e32; 
   padding: 1.2rem; /* Gi·∫£m padding tr√™n mobile */
   border-radius: 1rem; 
   width: 95%; /* TƒÉng % width tr√™n mobile */
   max-width: 500px;
   border: 1px solid #334155; 
   box-shadow: 0 20px 50px rgba(0,0,0,0.5);
   max-height: 90vh; 
   overflow-y: auto;
   margin: 1rem; /* Th√™m margin ƒë·ªÉ kh√¥ng s√°t c·∫°nh m√†n h√¨nh */
}
.setting-input {
   width: 100%; 
   background: #0b1121; 
   border: 1px solid #334155;
   color: #e2e8f0; 
   padding: 10px; 
   border-radius: 8px; 
   font-size: 14px;
   min-height: 44px; /* ƒê·∫£m b·∫£o ƒë·ªß l·ªõn ƒë·ªÉ ch·∫°m */
}
.setting-input:focus { border-color: #3b82f6; outline: none; }

/* Model List */
.model-list-container {
   max-height: 150px; 
   overflow-y: auto; 
   border: 1px solid #334155;
   border-radius: 8px; 
   padding: 8px; 
   background: #0b1121; 
   margin-bottom: 10px;
}
.model-item {
   display: flex; 
   justify-content: space-between; 
   align-items: center;
   padding: 8px; 
   background: #1e293b; 
   margin-bottom: 5px; 
   border-radius: 6px; 
   font-size: 13px;
   min-height: 44px; /* ƒê·∫£m b·∫£o ƒë·ªß l·ªõn ƒë·ªÉ ch·∫°m */
}
.remove-model-btn { 
   color: #ef4444; 
   cursor: pointer; 
   padding: 6px; /* TƒÉng padding cho d·ªÖ ch·∫°m */
   border-radius: 4px;
   display: flex;
   align-items: center;
   justify-content: center;
   width: 32px;
   height: 32px;
}

/* --- MOBILE RESPONSIVE FIXES (ƒê√É TH√äM M·ªöI) --- */
@media (max-width: 768px) {
   .messages-area { 
      padding: 0.5rem; /* Gi·∫£m l·ªÅ tr√™n mobile */
   } 
   .user-bubble { 
      max-width: 90%; 
      padding: 0.6rem 0.8rem; 
      font-size: 14px; 
   }
   .ai-bubble { 
      padding: 0.8rem; 
      font-size: 14px; 
   }
   .ai-bubble pre { 
      font-size: 11px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ code block */
      padding: 0.6em; 
   }
   .input-area { 
      padding: 0.5rem; 
   }
   
   /* Tinh ch·ªânh header/toggle cho g·ªçn */
   .squad-mode-toggle { 
      font-size: 10px; 
   }
   .toggle-switch { 
      width: 28px; 
      height: 16px; 
   }
   .toggle-switch::after { 
      width: 12px; 
      height: 12px; 
   }
   .squad-mode-toggle.active .toggle-switch::after { 
      transform: translateX(12px); 
   }

   /* File preview g·ªçn h∆°n */
   #filePreview span { 
      max-width: 100px; 
      overflow: hidden; 
      text-overflow: ellipsis; 
      white-space: nowrap; 
      display: inline-block; 
      vertical-align: bottom; 
   }
   
   /* ƒêi·ªÅu ch·ªânh modal cho mobile nh·ªè h∆°n */
   .modal-content {
      padding: 1rem;
      width: 92%;
      margin: 0.5rem;
   }
   
   /* ƒêi·ªÅu ch·ªânh padding cho c√°c ph·∫ßn t·ª≠ trong modal */
   .modal-content .setting-input,
   .modal-content .model-item {
      min-height: 42px;
   }
}

/* Th√™m breakpoint cho m√†n h√¨nh r·∫•t nh·ªè */
@media (max-width: 480px) {
   body {
      font-size: 14px;
   }
   
   .messages-area {
      padding: 0.4rem;
   }
   
   .user-bubble {
      max-width: 92%;
      padding: 0.5rem 0.7rem;
      font-size: 13px;
   }
   
   .ai-bubble {
      padding: 0.7rem;
      font-size: 13px;
      line-height: 1.5;
   }
   
   .ai-bubble h1 {
      font-size: 1.3em;
   }
   
   .ai-bubble h2 {
      font-size: 1.2em;
   }
   
   .ai-bubble h3 {
      font-size: 1.1em;
   }
   
   .input-wrapper {
      border-radius: 18px;
      padding: 4px;
   }
   
   textarea {
      font-size: 14px;
      padding: 7px 9px;
   }
   
   .action-btn {
      width: 36px;
      height: 36px;
   }
   
   .suggestion-chips {
      padding: 0 0.4rem 0.4rem 0.4rem;
   }
   
   .chip {
      padding: 4px 8px;
      font-size: 10px;
   }
}

/* --- DEBATE MODE STYLES --- */
.squad-mode-toggle.debate-active .toggle-switch { 
   background: #ef4444; 
   box-shadow: 0 0 10px #ef4444; 
}
.squad-mode-toggle.debate-active .toggle-switch::after { 
   transform: translateX(14px); 
   background: #fff; 
}
.debate-active-border { 
   border: 1px solid #ef4444 !important; 
   box-shadow: 0 0 15px rgba(239, 68, 68, 0.2); 
}

/* --- CINEMA MODE STYLES --- */
.cinema-title {
   text-align: center;
   background: linear-gradient(90deg, #000, #1a1a2e, #000);
   padding: 8px; /* Gi·∫£m padding tr√™n mobile */
   border-radius: 8px;
   border: 1px solid #475569;
   margin-bottom: 12px; /* Gi·∫£m margin */
   position: relative;
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.cinema-title h3 {
   color: #fbbf24;
   font-family: 'Outfit', sans-serif;
   font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ tr√™n mobile */
   margin: 0;
   letter-spacing: 1px; /* Gi·∫£m letter-spacing */
   text-transform: uppercase;
}

.film-strip {
   height: 2px; /* Gi·∫£m chi·ªÅu cao tr√™n mobile */
   background: repeating-linear-gradient(
       90deg,
       transparent,
       transparent 8px, /* Gi·∫£m kho·∫£ng c√°ch */
       #fbbf24 8px,
       #fbbf24 16px
   );
   flex: 1;
   margin: 0 8px; /* Gi·∫£m margin */
}

.topic-banner {
   background: rgba(220, 38, 38, 0.2);
   border: 2px solid #ef4444;
   padding: 10px; /* Gi·∫£m padding tr√™n mobile */
   text-align: center;
   font-size: 16px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   font-weight: bold;
   color: #fecaca;
   border-radius: 8px;
   margin: 8px 0; /* Gi·∫£m margin */
   font-family: 'Outfit', sans-serif;
   letter-spacing: 0.5px; /* Gi·∫£m letter-spacing */
}

.scene-desc {
   font-size: 10px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #94a3b8;
   text-align: center;
   margin-bottom: 16px; /* Gi·∫£m margin */
   font-style: italic;
   line-height: 1.4;
}

.cinema-screen {
   border: 2px solid #334155; /* Gi·∫£m border width */
   border-radius: 8px; /* Gi·∫£m border-radius */
   padding: 12px; /* Gi·∫£m padding */
   margin-bottom: 16px; /* Gi·∫£m margin */
   background: #0f172a;
   position: relative;
   overflow: hidden;
}

.cinema-screen::before {
   content: '';
   position: absolute;
   top: 0;
   left: 0;
   right: 0;
   height: 1px; /* Gi·∫£m chi·ªÅu cao */
   background: linear-gradient(90deg, transparent, #60a5fa, transparent);
}

.character-intro {
   display: flex;
   justify-content: space-between;
   align-items: center;
   padding: 8px 0; /* Gi·∫£m padding */
   border-bottom: 1px dashed #475569;
   margin-bottom: 8px; /* Gi·∫£m margin */
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.character-a {
   color: #60a5fa;
   font-weight: bold;
   font-size: 11px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.character-b {
   color: #f87171;
   font-weight: bold;
   font-size: 11px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.vs {
   font-size: 18px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #fbbf24;
   animation: pulse 1.5s infinite;
}

.take-number {
   background: rgba(0, 0, 0, 0.3);
   padding: 1px 5px; /* Gi·∫£m padding */
   border-radius: 10px;
   border: 1px solid #475569;
   font-size: 0.8em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.film-ending {
   text-align: center;
   padding: 16px; /* Gi·∫£m padding */
}

.credits-roll {
   animation: scrollUp 10s linear;
}

.credits {
   margin: 12px 0; /* Gi·∫£m margin */
   font-size: 11px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #cbd5e1;
}

.credits div {
   margin: 4px 0; /* Gi·∫£m margin */
   padding: 2px 0; /* Gi·∫£m padding */
   border-bottom: 1px dotted #334155;
}

.review {
   margin-top: 16px; /* Gi·∫£m margin */
   padding: 8px; /* Gi·∫£m padding */
   background: rgba(139, 92, 246, 0.1);
   border-radius: 8px;
   color: #a78bfa;
   font-size: 13px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   font-weight: bold;
}

@keyframes pulse {
   0%, 100% { opacity: 1; transform: scale(1); }
   50% { opacity: 0.7; transform: scale(1.1); }
}

@keyframes scrollUp {
   from { transform: translateY(50px); opacity: 0; }
   to { transform: translateY(0); opacity: 1; }
}

/* Highlight dialogue bubbles for short lines */
.ai-card .ai-bubble {
   font-size: 15px; /* ƒêi·ªÅu ch·ªânh cho mobile */
   font-weight: 500;
   line-height: 1.4;
   padding: 10px 12px; /* ƒêi·ªÅu ch·ªânh padding */
}

/* Cinema mode specific */
.ai-card[cinema-mode] .ai-bubble {
   background: rgba(255, 255, 255, 0.05);
   border-radius: 8px;
   border-left: 3px solid; /* Gi·∫£m border width */
   animation: typewriter 0.3s steps(20);
}

@keyframes typewriter {
   from { opacity: 0; transform: translateY(5px); }
   to { opacity: 1; transform: translateY(0); }
}      

/* Th√™m v√†o trong th·∫ª <style> */

/* Tr·∫°ng th√°i Input khi ·ªü ch·∫ø ƒë·ªô Debate */
.input-wrapper.debate-mode-active {
   border-color: #ef4444 !important;
   background: rgba(239, 68, 68, 0.05);
   box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
}

/* Khi click v√†o input ·ªü ch·∫ø ƒë·ªô Debate */
.input-wrapper.debate-mode-active:focus-within {
   box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
   border-color: #f87171 !important;
}

/* ƒê·ªïi m√†u icon g·ª≠i th√†nh m√†u ƒë·ªè cho h·ª£p t√¥ng */
.input-wrapper.debate-mode-active .send-btn {
   color: #ef4444;
}
.input-wrapper.debate-mode-active .send-btn:hover {
   background: #ef4444;
   color: white;
}
   
/* --- REFEREE JUDGE STYLES (TR·ªåNG T√ÄI) --- */
.referee-card {
   border: 2px solid #fbbf24 !important;
   background: linear-gradient(180deg, rgba(251, 191, 36, 0.05) 0%, rgba(0,0,0,0) 100%) !important;
   margin-top: 25px; /* Gi·∫£m margin tr√™n mobile */
   position: relative;
   overflow: hidden;
   animation: slideUpReferee 0.6s cubic-bezier(0.22, 1, 0.36, 1);
}

/* Hi·ªáu ·ª©ng qu√©t s√°ng b√≥ng */
.referee-card::before {
   content: '';
   position: absolute;
   top: 0; left: -100%;
   width: 50%; height: 100%;
   background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.2), transparent);
   animation: shine 3s infinite;
}

.referee-header {
   background: #451a03;
   border-bottom: 1px solid #fbbf24;
   color: #fbbf24;
   padding: 8px 10px; /* Gi·∫£m padding tr√™n mobile */
   font-family: 'Outfit', sans-serif;
   text-transform: uppercase;
   font-weight: 900;
   letter-spacing: 1px; /* Gi·∫£m letter-spacing */
   display: flex;
   align-items: center;
   justify-content: center;
   gap: 8px; /* Gi·∫£m gap */
   font-size: 0.9em; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

/* Animation hi·ªÉn th·ªã */
@keyframes slideUpReferee {
   from { transform: translateY(50px); opacity: 0; }
   to { transform: translateY(0); opacity: 1; }
}
@keyframes shine {
   0% { left: -100%; }
   20% { left: 200%; }
   100% { left: 200%; }
}

/* --- SYNTHESIS MODE STYLES --- */
.synthesis-active .toggle-switch { 
   background: #fbbf24; 
   box-shadow: 0 0 10px #fbbf24; 
}
.synthesis-active .toggle-switch::after { 
   transform: translateX(14px); 
   background: #000; 
}

.synthesis-card {
   border: 1px solid #fbbf24 !important;
   background: linear-gradient(135deg, rgba(251, 191, 36, 0.05), rgba(0,0,0,0.2));
   box-shadow: 0 0 20px rgba(251, 191, 36, 0.1);
}
.synthesis-step {
   font-size: 10px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   color: #94a3b8; 
   border-left: 2px solid #334155;
   padding-left: 8px; /* Gi·∫£m padding */
   margin: 4px 0; /* Gi·∫£m margin */
   opacity: 0.7;
}
.synthesis-step.active {
   color: #fbbf24; 
   border-color: #fbbf24; 
   opacity: 1; 
   font-weight: bold;
   animation: pulse 1s infinite;
}
.raw-results-container {
   display: flex; 
   gap: 4px; /* Gi·∫£m gap */
   overflow-x: auto; 
   padding-bottom: 5px; 
   margin-bottom: 10px; 
   opacity: 0.6;
}
.raw-card {
   min-width: 180px; /* Gi·∫£m min-width */
   font-size: 9px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   background: #000; 
   border: 1px solid #334155; 
   padding: 4px; /* Gi·∫£m padding */
   border-radius: 4px; 
   max-height: 90px; /* Gi·∫£m max-height */
   overflow: hidden;
}

/* CSS cho Panel L·ªãch s·ª≠ tr∆∞·ª£t m∆∞·ª£t m√† */
#historyPanel {
   transform: translateX(-100%); /* M·∫∑c ƒë·ªãnh ·∫©n sang tr√°i */
   transition: transform 0.3s ease-in-out;
   width: 85%; /* Gi·∫£m width tr√™n mobile */
   max-width: 300px;
}
#historyPanel.active {
   transform: translateX(0); /* Khi c√≥ class active th√¨ tr∆∞·ª£t ra */
}

/* T√πy ch·ªânh thanh cu·ªôn cho danh s√°ch l·ªãch s·ª≠ */
.custom-scrollbar::-webkit-scrollbar { 
   width: 3px; /* Gi·∫£m ƒë·ªô r·ªông tr√™n mobile */
}
.custom-scrollbar::-webkit-scrollbar-track { 
   background: #0f172a; 
}
.custom-scrollbar::-webkit-scrollbar-thumb { 
   background: #334155; 
   border-radius: 2px; 
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover { 
   background: #475569; 
}

/* Th√™m style cho l·ªãch s·ª≠ chat tr√™n mobile */
.history-item {
   padding: 12px 15px; /* ƒêi·ªÅu ch·ªânh padding */
   border-bottom: 1px solid #1e293b;
   cursor: pointer;
   transition: background 0.2s;
   font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
   line-height: 1.4;
   min-height: 44px; /* ƒê·∫£m b·∫£o ƒë·ªß l·ªõn ƒë·ªÉ ch·∫°m */
   display: flex;
   align-items: center;
}
.history-item:hover {
   background: #1e293b;
}

/* ƒêi·ªÅu ch·ªânh c√°c n√∫t trong history panel cho mobile */
.history-panel-header {
   padding: 15px; /* ƒêi·ªÅu ch·ªânh padding */
   border-bottom: 1px solid #1e293b;
   display: flex;
   justify-content: space-between;
   align-items: center;
   font-size: 16px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
}

.history-panel-header button {
   padding: 8px 12px; /* ƒêi·ªÅu ch·ªânh padding */
   border-radius: 6px;
   min-height: 36px; /* ƒê·∫£m b·∫£o ƒë·ªß l·ªõn ƒë·ªÉ ch·∫°m */
}

/* ƒêi·ªÅu ch·ªânh cho c√°c m√†n h√¨nh r·∫•t nh·ªè */
@media (max-width: 360px) {
   #historyPanel {
      width: 90%;
   }
   
   .history-item {
      padding: 10px 12px;
      font-size: 13px;
   }
   
   .history-panel-header {
      padding: 12px;
      font-size: 15px;
   }
}

/* C·∫£i thi·ªán hi·ªáu ·ª©ng tap cho t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ th·ªÉ t∆∞∆°ng t√°c */
.chip,
.action-btn,
.model-item,
.history-item,
.run-btn,
.remove-model-btn,
.squad-mode-toggle {
   -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
}

/* ƒê·∫£m b·∫£o kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o b·ªã tr√†n tr√™n mobile */
* {
   max-width: 100%;
}

/* C·∫£i thi·ªán hi·ªáu su·∫•t cu·ªôn tr√™n mobile */
.messages-area,
.model-list-container,
.custom-scrollbar {
   -webkit-overflow-scrolling: touch;
   overflow-scrolling: touch;
}

/* NgƒÉn ch·∫∑n zoom tr√™n input khi focus tr√™n iOS */
@media screen and (max-width: 768px) {
   textarea,
   .setting-input {
      font-size: 16px; /* NgƒÉn ch·∫∑n zoom tr√™n iOS */
   }
   
   /* ƒê·∫£m b·∫£o c√°c input kh√¥ng b·ªã ph√≥ng to tr√™n iOS */
   select,
   textarea,
   input[type="text"],
   input[type="search"],
   input[type="password"],
   input[type="email"],
   input[type="tel"] {
      font-size: 16px;
   }
}
